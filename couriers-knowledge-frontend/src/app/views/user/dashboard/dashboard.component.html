<!-- DASHBOARD.COMPONENT.HTML COMPLETO COM IMPORT/EXPORT - 100% TRADUZIDO -->

<div class="dashboard-container">
  <!-- Header principal -->

   <div class="dashboard-header">
    <!-- Primeira linha -->
    <div class="header-row-1">
      <h1>{{ 'dashboard.title' | translate }}</h1>

      <div class="row1-actions">
        <div class="import-export-aligned">
          <button
            class="import-btn"
            [class.limit-reached]="isImportLimitReached()"
            [disabled]="isImportLimitReached()"
            (click)="openImportModal()"
            [title]="'dashboard.tooltips.import' | translate"
          >
            {{ 'dashboard.buttons.import' | translate }}
            <span *ngIf="isImportLimitReached()" class="limit-badge">{{ 'dashboard.buttons.limit' | translate }}</span>
          </button>
        </div>

        <button
          class="selection-toggle-btn"
          [class.active]="isSelectionMode"
          (click)="toggleSelectionMode()"
          [title]="'dashboard.tooltips.selection' | translate"
        >
          {{ isSelectionMode ? ('dashboard.buttons.exitSelection' | translate) : ('dashboard.buttons.select' | translate) }}
        </button>

        <button
          class="new-evaluation-btn"
          [class.disabled]="isLimitReached"
          [disabled]="isLimitReached"
          (click)="openFormModal()"
          [title]="
            isLimitReached
              ? ('dashboard.tooltips.newEvaluationLimit' | translate)
              : ('dashboard.tooltips.newEvaluation' | translate)
          "
        >
          {{ 'dashboard.buttons.newEvaluation' | translate }}
        </button>
      </div>
    </div>

    <!-- Segunda linha -->
    <div class="header-row-2">
      <!-- Filtro de busca -->
      <div class="search-section">
        <div class="search-input-wrapper">
          <i class="search-icon">⌕</i>
          <input
            type="text"
            [placeholder]="'dashboard.search.placeholder' | translate"
            [formControl]="permanentSearchControl"
            class="permanent-search-input"
            #searchInput
          />
          <button
            *ngIf="permanentSearchControl.value"
            class="clear-search-btn"
            (click)="clearPermanentSearch()"
            [title]="'dashboard.search.clear' | translate"
          >
            ×
          </button>
        </div>

        <!-- Resultados da busca -->
        <div
          *ngIf="permanentSearchControl.value && filteredBySearch && filteredBySearch.length > 0"
          class="search-results-count"
        >
          {{ filteredBySearch.length }} {{ 'dashboard.search.resultsText' | translate }}
        </div>
        <div
          *ngIf="permanentSearchControl.value && filteredBySearch && filteredBySearch.length === 0"
          class="search-no-results"
        >
          {{ 'dashboard.search.noResults' | translate }}
        </div>
      </div>

      <div class="row2-actions">
        <div class="import-export-aligned">
          <button
            class="export-btn"
            [class.limit-reached]="isExportLimitReached()"
            [disabled]="isExportLimitReached()"
            (click)="openExportModal()"
            [title]="'dashboard.tooltips.export' | translate"
          >
            {{ 'dashboard.buttons.export' | translate }}
            <span *ngIf="isExportLimitReached()" class="limit-badge">{{ 'dashboard.buttons.limit' | translate }}</span>
          </button>
        </div>

        <button
          class="refresh-button"
          (click)="refreshNames()"
          [disabled]="isRefreshing"
          [title]="'dashboard.tooltips.updateNames' | translate"
        >
          {{ isRefreshing ? ('dashboard.buttons.updating' | translate) : ('dashboard.buttons.updateNames' | translate) }}
        </button>

        <!-- Status das avaliações -->
        <div class="evaluation-status-compact">
          <div *ngIf="evaluationStatus" class="status-display">
            <span class="count-text" [class.warning]="isLimitReached">
              {{ evaluationStatus.currentCount }}{{ evaluationStatus.limit ? '/' + evaluationStatus.limit : '' }}
            </span>
            <span class="plan-badge" [class.premium]="evaluationStatus.isPremium">
              {{ evaluationStatus.isPremium ? ('dashboard.status.premium' | translate) : ('dashboard.status.free' | translate) }}
            </span>
          </div>
        </div>
      </div>
    </div>

    <!-- Controles de seleção (quando ativo) -->
    <div *ngIf="isSelectionMode" class="selection-controls-row">
      <div class="selection-controls">
        <span class="selection-count">
          {{ getSelectedCount() }}/{{ getTotalDisplayed() }} {{ 'dashboard.selection.selectedText' | translate }}
        </span>
        <button
          class="select-all-btn"
          (click)="selectAllEvaluations()"
          [disabled]="getSelectedCount() === getTotalDisplayed()"
        >
          {{ 'dashboard.selection.selectAll' | translate }}
        </button>
        <button
          class="clear-selection-btn"
          (click)="clearAllSelections()"
          [disabled]="getSelectedCount() === 0"
        >
          {{ 'dashboard.selection.clearSelection' | translate }}
        </button>
      </div>
    </div>
  </div>


  <!-- Lista de avaliações -->
  <div class="evaluations-content">
    <!-- Loading -->
    <div *ngIf="isLoading" class="loading-container">
      <div class="loading-spinner"></div>
      <p>{{ 'dashboard.loading.evaluations' | translate }}</p>
    </div>

    <!-- Lista vazia -->
    <app-empty-state
      *ngIf="!isLoading && displayedEvaluations.length === 0"
      [config]="{
        type: 'evaluations',
        title: ('dashboard.empty.title' | translate),
        subtitle: ('dashboard.empty.subtitle' | translate),
        actionText: isLimitReached ? '' : ('dashboard.empty.action' | translate),
        showAction: !isLimitReached
      }"
      (actionClick)="openFormModal()"
    >
    </app-empty-state>

    <!-- Lista com dados -->
    <div
      *ngIf="!isLoading && displayedEvaluations.length > 0"
      class="evaluations-list"
    >
      <!-- Cabeçalho da lista -->
      <div class="list-header">
        <div class="header-col col-selection" *ngIf="isSelectionMode">
          <!-- Empty for checkbox column -->
        </div>
        <div class="header-col col-player">
          <div class="header-title">{{ 'dashboard.table.player' | translate }}</div>
        </div>
        <div class="header-col col-hero">
          <div class="header-title">{{ 'dashboard.table.hero' | translate }}</div>
        </div>
        <div class="header-col col-rating">
          <div class="header-title">{{ 'dashboard.table.rating' | translate }}</div>
        </div>
        <div class="header-col col-notes">
          <div class="header-title">{{ 'dashboard.table.notes' | translate }}</div>
        </div>
        <div class="header-col col-tags">
          <div class="header-title">{{ 'dashboard.table.tags' | translate }}</div>
        </div>
        <div class="header-col col-actions">
          <!-- Actions column -->
        </div>
      </div>

      <!-- Items da lista -->
      <div
        *ngFor="
          let evaluation of displayedEvaluations;
          trackBy: trackByEvaluationId
        "
        class="list-item"
        [class.selected]="isEvaluationSelected(evaluation.id)"
      >
        <!-- Checkbox de seleção -->
        <div *ngIf="isSelectionMode" class="col-selection">
          <input
            type="checkbox"
            [checked]="isEvaluationSelected(evaluation.id)"
            (change)="toggleEvaluationSelection(evaluation.id)"
            class="evaluation-checkbox"
          />
        </div>

        <!-- Coluna do jogador -->
        <div class="col-player" [attr.data-label]="('dashboard.table.player' | translate) + ':'">
          <div class="player-info-wrapper">
            <strong class="player-name">{{
              evaluation.targetPlayerName || ('dashboard.player.unknown' | translate)
            }}</strong>
            <small *ngIf="evaluation.target_player_steam_id" class="steam-id">
              {{ 'dashboard.player.id' | translate:{ steamId: evaluation.target_player_steam_id } }}
            </small>
            <small *ngIf="evaluation.match_id" class="match-id">
              {{ 'dashboard.player.match' | translate:{ matchId: evaluation.match_id } }}
            </small>
          </div>
        </div>

        <!-- Coluna do herói -->
        <div class="col-hero" [attr.data-label]="('dashboard.table.hero' | translate) + ':'">
          <div class="hero-info">
            <ng-container *ngIf="evaluation.hero_id; else noHero">
              <img
                [src]="gameDataService.getHeroImageUrl(evaluation.hero_id)"
                [alt]="
                  gameDataService.getHeroById(evaluation.hero_id)
                    ?.localized_name
                "
                class="hero-image"
                loading="lazy"
              />
              <span class="hero-name">
                {{
                  gameDataService.getHeroById(evaluation.hero_id)
                    ?.localized_name
                }}
              </span>
            </ng-container>
            <ng-template #noHero>
              <span class="no-info">{{ 'dashboard.hero.notInformed' | translate }}</span>
            </ng-template>
          </div>

          <div *ngIf="evaluation.role" class="role-badge">
            {{ evaluation.role }}
          </div>
        </div>

        <!-- Coluna da avaliação -->
        <div class="col-rating" [attr.data-label]="'dashboard.notes.label' | translate">
          <app-rating-display [rating]="evaluation.rating" />
        </div>

        <!-- Coluna das anotações -->
        <div class="col-notes" [attr.data-label]="('dashboard.table.notes' | translate) + ':'">
          <p *ngIf="evaluation.notes; else noNotes">
            {{ evaluation.notes }}
          </p>
          <ng-template #noNotes>
            <span class="no-info">{{ 'dashboard.notes.noNotes' | translate }}</span>
          </ng-template>
        </div>

        <!-- Coluna das tags -->
        <div class="col-tags" [attr.data-label]="('dashboard.table.tags' | translate) + ':'">
          <div class="tags-wrapper">
            <ng-container
              *ngIf="evaluation.tags && evaluation.tags.length > 0; else noTags"
            >
              <span *ngFor="let tag of evaluation.tags" class="tag-badge">
                {{ tag }}
              </span>
            </ng-container>
            <ng-template #noTags>
              <span class="no-info">{{ 'dashboard.tags.noTags' | translate }}</span>
            </ng-template>
          </div>
        </div>

        <!-- Coluna das ações -->
        <div class="col-actions">
          <div class="action-menu-container">
            <button
              class="action-menu-btn"
              (click)="toggleActionMenu($event, evaluation.id)"
              [class.active]="activeActionMenu === evaluation.id"
            >
              ⋮
            </button>

            <div
              *ngIf="activeActionMenu === evaluation.id"
              class="action-popover"
            >
              <button
                (click)="openFormModal(evaluation)"
                class="action-item edit"
              >
                {{ 'dashboard.actions.edit' | translate }}
              </button>
              <button
                (click)="shareEvaluation(evaluation)"
                class="action-item share"
              >
                {{ 'dashboard.actions.share' | translate }}
              </button>
              <button
                (click)="deleteEvaluation(evaluation.id)"
                class="action-item delete"
              >
                {{ 'dashboard.actions.delete' | translate }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- ===== MODAL DE EXPORTAÇÃO ===== -->
<div *ngIf="showExportModal" class="modal-overlay" (click)="closeExportModal()">
  <div class="modal export-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>
        {{ exportResult ? ('dashboard.export.success.title' | translate) : ('dashboard.export.title' | translate) }}
      </h3>
      <button class="modal-close-btn" (click)="closeExportModal()">×</button>
    </div>

    <div class="modal-content">
      <!-- ANTES da exportação -->
      <div *ngIf="!exportResult && !isExporting">
        <div class="export-options">
          <label class="radio-option">
            <input
              type="radio"
              name="exportType"
              value="all"
              [(ngModel)]="exportType"
              [disabled]="isExporting"
            />
            <span class="radio-label">
              <strong>{{ 'dashboard.export.all' | translate }}</strong>
              <small>({{ getTotalDisplayed() }} {{ 'dashboard.export.evaluationsText' | translate }})</small>
            </span>
          </label>

          <label
            class="radio-option"
            [class.disabled]="getSelectedCount() === 0"
          >
            <input
              type="radio"
              name="exportType"
              value="selected"
              [(ngModel)]="exportType"
              [disabled]="isExporting || getSelectedCount() === 0"
            />
            <span class="radio-label">
              <strong>{{ 'dashboard.export.selected' | translate }}</strong>
              <small>({{ getSelectedCount() }} {{ 'dashboard.export.evaluationsText' | translate }})</small>
            </span>
          </label>
        </div>

        <div class="export-info">
          <div class="info-box">
            <h4>{{ 'dashboard.export.whatWillBeExported' | translate }}</h4>
            <ul>
              <li>{{ 'dashboard.export.jsonFile' | translate }}</li>
              <li>{{ 'dashboard.export.shareCode' | translate }}</li>
              <li>{{ 'dashboard.export.completeData' | translate }}</li>
              <li>{{ 'dashboard.export.playerInfo' | translate }}</li>
            </ul>
          </div>
        </div>
      </div>

      <!-- DURANTE a exportação -->
      <div *ngIf="isExporting" class="export-loading">
        <div class="loading-spinner"></div>
        <p>{{ 'dashboard.export.processing' | translate }}</p>
        <small>{{ 'dashboard.export.generating' | translate }}</small>
      </div>

      <!-- DEPOIS da exportação - MOSTRAR CÓDIGO -->
      <div *ngIf="exportResult && !isExporting" class="export-success">
        <div class="success-message">
          <h4>{{ 'dashboard.export.success.completed' | translate }}</h4>
          <p>{{ exportResult.totalEvaluations }} {{ 'dashboard.export.success.evaluationsExported' | translate }}</p>
        </div>

        <!-- CÓDIGO DE COMPARTILHAMENTO -->
        <div class="share-code-section">
          <h4>{{ 'dashboard.export.success.shareCodeTitle' | translate }}</h4>
          <div class="share-code-display">
            <div class="code-box">
              <span class="share-code-text">{{
                formatShareCode(exportResult.shareCode)
              }}</span>
              <button
                class="copy-code-btn"
                (click)="copyShareCode()"
                [title]="'dashboard.export.success.copyCode' | translate"
              >
                📋
              </button>
            </div>
          </div>

          <div class="code-instructions">
            <p><strong>{{ 'dashboard.export.success.howToShare' | translate }}</strong></p>
            <ul>
              <li>{{ 'dashboard.export.success.step1' | translate }}</li>
              <li>{{ 'dashboard.export.success.step2' | translate }}</li>
              <li>{{ 'dashboard.export.success.step3' | translate }}</li>
            </ul>

            <div class="code-details">
              <small>
                <strong>{{ 'dashboard.export.success.validUntil' | translate }}</strong>
                {{ exportResult.exportedAt | date : "dd/MM/yyyy" }} {{ 'dashboard.export.success.thirtyDays' | translate }}<br />
                <strong>{{ 'dashboard.export.success.jsonFileLabel' | translate }}</strong> {{ 'dashboard.export.success.downloadedAutomatically' | translate }}
              </small>
            </div>
          </div>
        </div>

        <!-- EXEMPLO DE USO -->
        <div class="usage-example">
          <h5>{{ 'dashboard.export.success.messageExample' | translate }}</h5>
          <div class="example-message">
            {{ 'dashboard.export.success.exampleText1' | translate }}<br />
            {{ 'dashboard.export.success.exampleText2' | translate }}
            <strong>{{ formatShareCode(exportResult.shareCode) }}</strong><br />
            {{ 'dashboard.export.success.exampleText3' | translate }}
          </div>
        </div>
      </div>
    </div>

    <div class="modal-actions">
      <!-- Botões ANTES da exportação -->
      <ng-container *ngIf="!exportResult && !isExporting">
        <button
          (click)="exportEvaluations()"
          class="btn-primary"
          [disabled]="
            isExporting ||
            (exportType === 'selected' && getSelectedCount() === 0)
          "
        >
          <span *ngIf="!isExporting">{{ 'dashboard.modal.export' | translate }}</span>
          <span *ngIf="isExporting">
            <span class="spinner"></span>
            {{ 'dashboard.export.exporting' | translate }}
          </span>
        </button>
        <button
          (click)="closeExportModal()"
          class="btn-secondary"
          [disabled]="isExporting"
        >
          {{ 'dashboard.modal.cancel' | translate }}
        </button>
      </ng-container>

      <!-- Botões DEPOIS da exportação -->
      <ng-container *ngIf="exportResult && !isExporting">
        <button (click)="copyShareCode()" class="btn-primary">
          📋 {{ 'dashboard.export.success.copyCodeButton' | translate }}
        </button>
        <button (click)="closeExportModal()" class="btn-secondary">
          {{ 'dashboard.modal.close' | translate }}
        </button>
      </ng-container>
    </div>
  </div>
</div>

<!-- ===== MODAL DE IMPORTAÇÃO ===== -->
<div *ngIf="showImportModal" class="modal-overlay" (click)="closeImportModal()">
  <div class="modal import-modal" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ 'dashboard.import.title' | translate }}</h3>
      <button class="modal-close-btn" (click)="closeImportModal()">×</button>
    </div>

    <div class="modal-content">
      <!-- Tabs de importação -->
      <div class="import-tabs">
        <button
          class="tab-btn"
          [class.active]="importTab === 'paste'"
          (click)="importTab = 'paste'"
          [disabled]="isImporting"
        >
          <i>📋</i> {{ 'dashboard.import.tabs.paste' | translate }}
        </button>

        <button
          class="tab-btn"
          [class.active]="importTab === 'file'"
          (click)="importTab = 'file'"
          [disabled]="isImporting"
        >
          <i>📁</i> {{ 'dashboard.import.tabs.file' | translate }}
        </button>

        <button
          class="tab-btn"
          [class.active]="importTab === 'code'"
          (click)="importTab = 'code'"
          [disabled]="isImporting"
        >
          <i>🔗</i> {{ 'dashboard.import.tabs.code' | translate }}
        </button>
      </div>

      <!-- Conteúdo das tabs -->
      <div class="import-content">
        <!-- Tab de colar (NOVA) -->
        <div *ngIf="importTab === 'paste'" class="paste-import-section">
          <div class="paste-description">
            <p>
              <i>📋</i>
              <strong>{{ 'dashboard.import.paste.description' | translate }}</strong><br />
              <small>{{ 'dashboard.import.paste.subtitle' | translate }}</small>
            </p>
          </div>

          <div class="paste-input-wrapper">
            <textarea
              [placeholder]="'dashboard.import.paste.placeholder' | translate"
              [(ngModel)]="pastedText"
              (input)="onPastedTextChange()"
              class="paste-textarea"
              [disabled]="isImporting"
              rows="10"
            ></textarea>
          </div>

          <!-- Preview dos dados colados -->
          <div *ngIf="pastedPreview" class="import-preview">
            <h4>{{ 'dashboard.import.preview.title' | translate }}</h4>
            <div class="preview-info">
              <div class="preview-item">
                <strong>{{ 'dashboard.import.preview.total' | translate }}</strong> {{ pastedPreview.total }}
              </div>
              <div class="preview-item">
                <strong>{{ 'dashboard.import.preview.type' | translate }}</strong>
                <span *ngIf="pastedPreview.type === 'text'">{{ 'dashboard.import.preview.friendlyText' | translate }}</span>
                <span *ngIf="pastedPreview.type === 'json'">{{ 'dashboard.import.preview.jsonData' | translate }}</span>
              </div>
              <div class="preview-item">
                <strong>{{ 'dashboard.import.preview.source' | translate }}</strong> {{ pastedPreview.exportedBy }}
              </div>
              <div class="preview-item" *ngIf="pastedPreview.exportedAt">
                <strong>{{ 'dashboard.import.preview.date' | translate }}</strong>
                {{ pastedPreview.exportedAt | date : "dd/MM/yyyy HH:mm" }}
              </div>
              <div
                class="preview-item"
                *ngIf="
                  pastedPreview.type === 'text' && pastedPreview.evaluation
                "
              >
                <strong>{{ 'dashboard.import.preview.player' | translate }}</strong>
                {{ pastedPreview.evaluation.target_player_name || "N/A" }}
              </div>
              <div
                class="preview-item"
                *ngIf="
                  pastedPreview.type === 'text' && pastedPreview.evaluation
                "
              >
                <strong>{{ 'dashboard.import.preview.rating' | translate }}</strong>
                {{ pastedPreview.evaluation.rating || "N/A" }}/5
              </div>
            </div>
          </div>

          <div class="paste-help">
            <div class="help-tips">
              <h5>{{ 'dashboard.import.paste.howToUse' | translate }}</h5>
              <ul>
                <li>
                  <strong>{{ 'dashboard.import.paste.receive' | translate }}</strong>: {{ 'dashboard.import.paste.receiveDesc' | translate }}
                </li>
                <li>
                  <strong>{{ 'dashboard.import.paste.paste' | translate }}</strong>: {{ 'dashboard.import.paste.pasteDesc' | translate }}
                </li>
                <li>
                  <strong>{{ 'dashboard.import.paste.import' | translate }}</strong>: {{ 'dashboard.import.paste.importDesc' | translate }}
                </li>
              </ul>

              <div class="format-examples">
                <h6>{{ 'dashboard.import.paste.acceptedFormats' | translate }}</h6>
                <div class="format-item">
                  <strong>{{ 'dashboard.import.paste.friendlyTextFormat' | translate }}</strong> {{ 'dashboard.import.paste.casualSharing' | translate }}
                </div>
                <div class="format-item">
                  <strong>{{ 'dashboard.import.paste.jsonFormat' | translate }}</strong> {{ 'dashboard.import.paste.completeExport' | translate }}
                </div>
              </div>
            </div>

            <div class="paste-shortcuts">
              <small>
                <strong>{{ 'dashboard.import.paste.shortcuts' | translate }}</strong> {{ 'dashboard.import.paste.shortcutsList' | translate }}
              </small>
            </div>
          </div>
        </div>

        <!-- Tab de arquivo -->
        <div *ngIf="importTab === 'file'" class="file-import-section">
          <input
            type="file"
            accept=".json"
            (change)="onFileSelected($event)"
            #fileInput
            class="file-input"
            [disabled]="isImporting"
          />

          <div
            class="file-drop-zone"
            [class.drag-over]="isDragOver"
            [class.has-file]="selectedFile"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onFileDropped($event)"
            (click)="fileInput.click()"
          >
            <div *ngIf="!selectedFile" class="drop-zone-empty">
              <i class="drop-icon">☁️</i>
              <p class="drop-text">
                <strong>{{ 'dashboard.import.file.dragHere' | translate }}</strong><br />
                {{ 'dashboard.import.file.orClickToSelect' | translate }}
              </p>
              <small>{{ 'dashboard.import.file.maxSize' | translate }}</small>
            </div>

            <div *ngIf="selectedFile" class="drop-zone-file">
              <i class="file-icon">📄</i>
              <div class="file-info">
                <strong>{{ selectedFile.name }}</strong>
                <small>{{ (selectedFile.size / 1024).toFixed(1) }} KB</small>
              </div>
              <button
                class="remove-file-btn"
                (click)="
                  $event.stopPropagation();
                  selectedFile = null;
                  importPreview = null
                "
                [disabled]="isImporting"
              >
                ×
              </button>
            </div>
          </div>

          <!-- Preview do arquivo -->
          <div *ngIf="importPreview" class="import-preview">
            <h4>{{ 'dashboard.import.preview.title' | translate }}</h4>
            <div class="preview-info">
              <div class="preview-item">
                <strong>{{ 'dashboard.import.preview.total' | translate }}</strong> {{ importPreview.total }}
              </div>
              <div class="preview-item">
                <strong>{{ 'dashboard.import.preview.exportedBy' | translate }}</strong> {{ importPreview.exportedBy }}
              </div>
              <div class="preview-item" *ngIf="importPreview.exportedAt">
                <strong>{{ 'dashboard.import.preview.exportedAt' | translate }}</strong>
                {{ importPreview.exportedAt | date : "dd/MM/yyyy HH:mm" }}
              </div>
              <div class="preview-item">
                <strong>{{ 'dashboard.import.preview.version' | translate }}</strong> {{ importPreview.version }}
              </div>
            </div>
          </div>
        </div>

        <!-- Tab de código -->
        <div *ngIf="importTab === 'code'" class="code-import-section">
          <div class="code-input-wrapper">
            <input
              type="text"
              [placeholder]="'dashboard.import.code.placeholder' | translate"
              [(ngModel)]="shareCode"
              class="share-code-input"
              [disabled]="isImporting"
              maxlength="16"
            />
          </div>

          <div class="code-help">
            <p class="help-text">
              <i>💡</i>
              {{ 'dashboard.import.code.help' | translate }}
            </p>
          </div>
        </div>
      </div>

      <!-- Modo de importação -->
      <div class="import-mode-section">
        <h4>{{ 'dashboard.import.mode.title' | translate }}</h4>
        <div class="mode-options">
          <label class="mode-option">
            <input
              type="radio"
              name="importMode"
              value="add"
              [(ngModel)]="importMode"
              [disabled]="isImporting"
            />
            <span class="mode-label">
              <strong>{{ 'dashboard.import.mode.add.title' | translate }}</strong>
              <small>{{ 'dashboard.import.mode.add.description' | translate }}</small>
            </span>
          </label>

          <label class="mode-option">
            <input
              type="radio"
              name="importMode"
              value="merge"
              [(ngModel)]="importMode"
              [disabled]="isImporting"
            />
            <span class="mode-label">
              <strong>{{ 'dashboard.import.mode.merge.title' | translate }}</strong>
              <small>{{ 'dashboard.import.mode.merge.description' | translate }}</small>
            </span>
          </label>

          <label class="mode-option">
            <input
              type="radio"
              name="importMode"
              value="replace"
              [(ngModel)]="importMode"
              [disabled]="isImporting"
            />
            <span class="mode-label">
              <strong>{{ 'dashboard.import.mode.replace.title' | translate }}</strong>
              <small>{{ 'dashboard.import.mode.replace.description' | translate }}</small>
            </span>
          </label>
        </div>

        <p class="mode-description">
          <i>ℹ️</i>
          {{ getImportModeDescription() }}
        </p>
      </div>
    </div>

    <div class="modal-actions">
      <button
        (click)="importEvaluations()"
        class="btn-primary"
        [disabled]="isImporting || !canImport()"
      >
        <span *ngIf="!isImporting">{{ 'dashboard.modal.import' | translate }}</span>
        <span *ngIf="isImporting">
          <span class="spinner"></span>
          {{ 'dashboard.import.importing' | translate }}
        </span>
      </button>
      <button
        (click)="closeImportModal()"
        class="btn-secondary"
        [disabled]="isImporting"
      >
        {{ 'dashboard.modal.cancel' | translate }}
      </button>
    </div>
  </div>
</div>

<!-- Modal do formulário de avaliação -->
<app-evaluation-form
  *ngIf="isFormModalVisible"
  [evaluationData]="selectedEvaluation"
  (formSubmitted)="onFormSubmitted()"
  (formClosed)="onFormClosed()"
  (evaluationError)="onEvaluationError($event)"
></app-evaluation-form>


<app-confirmation-modal
  [isVisible]="showConfirmationModal"
  [title]="confirmationConfig.title"
  [message]="confirmationConfig.message"
  [confirmText]="confirmationConfig.confirmText"
  [cancelText]="confirmationConfig.cancelText"
  [confirmButtonType]="'danger'"
  [icon]="'🗑️'"
  [isLoading]="confirmationConfig.isLoading"
  (onConfirm)="onConfirmDelete()"
  (onCancel)="onCancelDelete()"
  (onClose)="onCancelDelete()"
>
</app-confirmation-modal>
